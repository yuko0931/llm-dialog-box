import{d as y,u as C,s as z,r as c,c as r,a as s,b as F,F as I,e as b,w as k,v as V,f as M,n as S,g as A,h as L,o as d,i as B,_ as D}from"./index-CCyrc4BV.js";import{f as K,u as N,U}from"./index-7B8ir-Fl.js";const E={class:"input-box"},R={class:"input-wrapper"},T={key:0,class:"filearea-wrapper"},j={class:"textarea-wrapper"},q={class:"button-wrapper"},J=y({__name:"IndeInit",setup(O){const v=C(),{firstSendQuery:f,firstSendFiles:m,conversationList:u}=z(v),g=L(),i=c(""),o=c(null),t=c([]),p=async()=>{const a=i.value.trim();if(i.value="",!a)return;console.log(a);const e=t.value;t.value=[];const n=await A(),l=n.id;u.value.unshift({title:a.length>30?`${a.substring(0,30)}`:a,date:new Date,coversation_id:n.id}),localStorage.setItem("conversationList",JSON.stringify(u.value)),f.value=a,m.value=e,g.push({name:"chat",params:{conversationdId:l}})},h=a=>{a.shiftKey||(a.preventDefault(),p())},w=()=>{var a;console.log("上传附件中"),(a=o.value)==null||a.click()},_=async()=>{if(o.value&&o.value.files&&o.value.files.length>0){const a=Array.from(o.value.files);console.log("文件列表:",a);for(const e of a){if(t.value.find(l=>l.name===e.name)){console.log("不要上传重复的文件!");continue}t.value.push({id:"",name:e.name,size:K(e.size),isparsing:!1});const n=await N(e);t.value=t.value.map(l=>(l.name===e.name&&(l.isparsing=!0,l.id=n.id),l)),console.log("上传文件结果:",n),o.value.value=""}}},x=a=>{const e=t.value.findIndex(n=>n.name===a);e!==-1&&t.value.splice(e,1)};return(a,e)=>(d(),r("div",E,[e[3]||(e[3]=s("div",{class:"tip"},"有什么可以帮忙的？",-1)),s("div",R,[t.value.length>0?(d(),r("div",T,[(d(!0),r(I,null,b(t.value,(n,l)=>(d(),r("div",{key:l},[B(U,{name:n.name,size:n.size,isparsing:n.isparsing,onDeleteFile:x},null,8,["name","size","isparsing"])]))),128))])):F("",!0),s("div",j,[k(s("textarea",{"onUpdate:modelValue":e[0]||(e[0]=n=>i.value=n),name:"input-area",placeholder:"请输入要询问的问题",id:"input-area",onKeydown:M(h,["enter"])},null,544),[[V,i.value]])]),s("div",q,[s("input",{ref_key:"fileInput",ref:o,type:"file",multiple:"",accept:".doc,.docx,.xls,.xlsx,.ppt,.pptx,.pdf,.csv,.jpg,.png,.gif,.webp,.bmp,.pcd,.tiff",style:{display:"none"},onChange:_},null,544),s("div",{class:"attach btn",onClick:w},e[1]||(e[1]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 14 20",fill:"none"},[s("path",{d:"M7 20c-1.856-.002-3.635-.7-4.947-1.94C.74 16.819.003 15.137 0 13.383V4.828a4.536 4.536 0 0 1 .365-1.843 4.75 4.75 0 0 1 1.087-1.567A5.065 5.065 0 0 1 3.096.368a5.293 5.293 0 0 1 3.888 0c.616.244 1.174.6 1.643 1.05.469.45.839.982 1.088 1.567.25.586.373 1.212.364 1.843v8.555a2.837 2.837 0 0 1-.92 2.027A3.174 3.174 0 0 1 7 16.245c-.807 0-1.582-.3-2.158-.835a2.837 2.837 0 0 1-.92-2.027v-6.22a1.119 1.119 0 1 1 2.237 0v6.22a.777.777 0 0 0 .256.547.868.868 0 0 0 .585.224c.219 0 .429-.08.586-.224a.777.777 0 0 0 .256-.546V4.828A2.522 2.522 0 0 0 7.643 3.8a2.64 2.64 0 0 0-.604-.876 2.816 2.816 0 0 0-.915-.587 2.943 2.943 0 0 0-2.168 0 2.816 2.816 0 0 0-.916.587 2.64 2.64 0 0 0-.604.876 2.522 2.522 0 0 0-.198 1.028v8.555c0 1.194.501 2.339 1.394 3.183A4.906 4.906 0 0 0 7 17.885a4.906 4.906 0 0 0 3.367-1.319 4.382 4.382 0 0 0 1.395-3.183v-6.22a1.119 1.119 0 0 1 2.237 0v6.22c-.002 1.754-.74 3.436-2.052 4.677C10.635 19.3 8.856 19.998 7 20z",fill:"currentColor"})],-1)])),s("div",{class:S(["send btn",i.value.trim()?"active":""]),onClick:p},e[2]||(e[2]=[s("svg",{width:"14",height:"16",viewBox:"0 0 14 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[s("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M7 16c-.595 0-1.077-.462-1.077-1.032V1.032C5.923.462 6.405 0 7 0s1.077.462 1.077 1.032v13.936C8.077 15.538 7.595 16 7 16z",fill:"currentColor"}),s("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M.315 7.44a1.002 1.002 0 0 1 0-1.46L6.238.302a1.11 1.11 0 0 1 1.523 0c.421.403.421 1.057 0 1.46L1.838 7.44a1.11 1.11 0 0 1-1.523 0z",fill:"currentColor"}),s("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M13.685 7.44a1.11 1.11 0 0 1-1.523 0L6.238 1.762a1.002 1.002 0 0 1 0-1.46 1.11 1.11 0 0 1 1.523 0l5.924 5.678c.42.403.42 1.056 0 1.46z",fill:"currentColor"})],-1)]),2)])])]))}}),G=D(J,[["__scopeId","data-v-2793ff50"]]);export{G as default};
